/**
 * SVGInjector v1.1.3 - Fast, caching, dynamic inline SVG DOM injection library
 * https://github.com/iconic/SVGInjector
 *
 * Copyright (c) 2014-2015 Waybury <hello@waybury.com>
 * @license MIT
 */
!function(a,b){"use strict";function c(a){a=a.split(" ");for(var b={},c=a.length,d=[];c--;)b.hasOwnProperty(a[c])||(b[a[c]]=1,d.unshift(a[c]));return d.join(" ")}var d="file:"===a.location.protocol,e=b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),f=Array.prototype.forEach||function(a,b){if(void 0===this||null===this||"function"!=typeof a)throw new TypeError;var c,d=this.length>>>0;for(c=0;d>c;++c)c in this&&a.call(b,this[c],c,this)},g={},h=0,i=[],j=[],k={},l=function(a){return a.cloneNode(!0)},m=function(a,b){j[a]=j[a]||[],j[a].push(b)},n=function(a){for(var b=0,c=j[a].length;c>b;b++)!function(b){setTimeout(function(){j[a][b](l(g[a]))},0)}(b)},o=function(b,c){if(void 0!==g[b])g[b]instanceof SVGSVGElement?c(l(g[b])):m(b,c);else{if(!a.XMLHttpRequest)return c("Browser does not support XMLHttpRequest"),!1;g[b]={},m(b,c);var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){if(404===e.status||null===e.responseXML)return c("Unable to load SVG file: "+b),d&&c("Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver."),c(),!1;if(!(200===e.status||d&&0===e.status))return c("There was a problem injecting the SVG: "+e.status+" "+e.statusText),!1;if(e.responseXML instanceof Document)g[b]=e.responseXML.documentElement;else if(DOMParser){var a;try{var f=new DOMParser;a=f.parseFromString(e.responseText,"text/xml")}catch(h){a=void 0}if(!a||a.getElementsByTagName("parsererror").length)return c("Unable to parse SVG file: "+b),!1;g[b]=a.documentElement}n(b)}},e.open("GET",b),e.overrideMimeType&&e.overrideMimeType("text/xml"),e.send()}},p=function(b,d,g,j){var l=b.getAttribute("data-src")||b.getAttribute("src");if(!/\.svg/i.test(l))return void j("Attempted to inject a file with a non-svg extension: "+l);if(!e){var m=b.getAttribute("data-fallback")||b.getAttribute("data-png");return void(m?(b.setAttribute("src",m),j(null)):g?(b.setAttribute("src",g+"/"+l.split("/").pop().replace(".svg",".png")),j(null)):j("This browser does not support SVG and no PNG fallback was defined."))}-1===i.indexOf(b)&&(i.push(b),b.setAttribute("src",""),o(l,function(e){if("undefined"==typeof e||"string"==typeof e)return j(e),!1;var g=b.getAttribute("id");g&&e.setAttribute("id",g);var m=b.getAttribute("title");m&&e.setAttribute("title",m);var n=[].concat(e.getAttribute("class")||[],"injected-svg",b.getAttribute("class")||[]).join(" ");e.setAttribute("class",c(n));var o=b.getAttribute("style");o&&e.setAttribute("style",o);var p=[].filter.call(b.attributes,function(a){return/^data-\w[\w\-]*$/.test(a.name)});f.call(p,function(a){a.name&&a.value&&e.setAttribute(a.name,a.value)});var q,r,s,t,u,v={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(v).forEach(function(a){q=a,s=v[a],r=e.querySelectorAll("defs "+q+"[id]");for(var b=0,c=r.length;c>b;b++){t=r[b].id,u=t+"-"+h;var d;f.call(s,function(a){d=e.querySelectorAll("["+a+'*="'+t+'"]');for(var b=0,c=d.length;c>b;b++)d[b].setAttribute(a,"url(#"+u+")")}),r[b].id=u}}),e.removeAttribute("xmlns:a");for(var w,x,y=e.querySelectorAll("script"),z=[],A=0,B=y.length;B>A;A++)x=y[A].getAttribute("type"),x&&"application/ecmascript"!==x&&"application/javascript"!==x||(w=y[A].innerText||y[A].textContent,z.push(w),e.removeChild(y[A]));if(z.length>0&&("always"===d||"once"===d&&!k[l])){for(var C=0,D=z.length;D>C;C++)new Function(z[C])(a);k[l]=!0}var E=e.querySelectorAll("style");f.call(E,function(a){a.textContent+=""}),b.parentNode.replaceChild(e,b),delete i[i.indexOf(b)],b=null,h++,j(e)}))},q=function(a,b,c){b=b||{};var d=b.evalScripts||"always",e=b.pngFallback||!1,g=b.each;if(void 0!==a.length){var h=0;f.call(a,function(b){p(b,d,e,function(b){g&&"function"==typeof g&&g(b),c&&a.length===++h&&c(h)})})}else a?p(a,d,e,function(b){g&&"function"==typeof g&&g(b),c&&c(1),a=null}):c&&c(0)};"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=q:"function"==typeof define&&define.amd?define(function(){return q}):"object"==typeof a&&(a.SVGInjector=q)}(window,document);var ngEnter=angular.module("ngEnter",[]);ngEnter.directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}});var dataProviderService=angular.module("dataProviderService",[]);dataProviderService.factory("dataProviderService",["$route","$q","$http","urls","cmsStatus","$translate",function(a,b,c,d,e,f){var g={getItem:function(a,b,c,d){return console.log(a),g.promiseRequest(a,b,c,"GET",d)},postItem:function(a,b,c,d,e){return this.promiseRequest(a,b,c,"POST",d,e)},putItem:function(a,b,c,d,e){return this.promiseRequest(a,b,c,"PUT",d,e)},deleteItem:function(a,b,c,d){return this.promiseRequest(a,b,c,"DELETE",null,d)},promiseRequest:function(a,c,f,g,h,i,j){var k=b.defer();return"function"==typeof a&&(a=a()),this.request(a,c,f,g,h,i,j).success(function(b,c,f,g){d.apiURL!==a||e.isOnline()||e.isOnline(!0),k.resolve(b)}).error(function(b,c,f,g){d.apiURL===a&&e.isOnline(!1),k.reject({data:b,status:c})}),k.promise},request:function(a,b,d,e,f,g,h){var i,j,k=!1;return g===!0&&(k=!1),i=a+b,console.log(i),"undefined"==typeof d&&(d={}),"POST"==e&&(k=!1),j={method:e,url:i,params:d,cache:k},"undefined"!=typeof f&&(j.data=f),"undefined"!=typeof h&&(j.responseType=h),c(j)}};return g}]);var TransparencyApp=angular.module("TransparencyApp",["config","ngRoute","ngEnter","ngCookies","ngMessages","ngSanitize","dataProviderService","pascalprecht.translate","ngclipboard","720kb.datepicker"]).service("cmsStatus",["$location",function(a){var b,c=!1,d=!0,e=!1;this.isOnline=function(f){return"undefined"==typeof f?c:(e=d||c||!f?!1:!0,f===!0?c=!0:(c=!1,a.path("/offline")),e&&a.path(b),void(d=!1))}}]).service("urls",["envOptions","$translate",function(a,b){return this.apiURL=function(){var b;a.languageCode;return b=a.apiDomain+a.apiRoot},this}]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https|mailto|whatsapp|http):/),a.debugInfoEnabled(!1)}]).config(["$cookiesProvider",function(a){a.defaults.secure=!0}]).config(["$translateProvider",function(a){a.useSanitizeValueStrategy("sanitizeParameters"),a.useStaticFilesLoader({prefix:"translations/locale-",suffix:".json"})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html"}).when("/main",{templateUrl:"views/main.html"}).when("/about",{templateUrl:"views/about.html"}).when("/resources",{templateUrl:"views/resources.html"}).when("/help",{templateUrl:"views/help.html"}).when("/admin",{templateUrl:"views/admin.html",controller:"AdminCtrl"}).when("/reports",{templateUrl:"views/report-list.html",controller:"ReportListCtrl",resolve:{reports:["dataProviderService","urls","envOptions",function(a,b,c){return a.getItem(b.apiURL(),"/transparency-reports")}]}}).when("/reports/:report_id",{templateUrl:"views/report.html",controller:"ReportCtrl",resolve:{report:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id)}]}}).when("/create-report",{templateUrl:"views/report.html",controller:"ReportCtrl",resolve:{report:function(){return null}}}).when("/reports/:report_id/retention-guide",{templateUrl:"views/retention-guide.html",controller:"RetentionGuideCtrl",resolve:{report:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id)}],guide:["$route","dataProviderService","urls","envOptions","$q",function(a,b,c,d,e){return e(function(d,e){b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/retention_guide").then(function(f){f?d(f):b.putItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/retention_guide",{},{}).then(function(a){d(a)})["catch"](function(a){e(a)})})["catch"](function(a){e(a)})})}]}}).when("/categories",{templateUrl:"views/category-list.html",controller:"CategoryListCtrl",resolve:{categories:["dataProviderService","urls","envOptions",function(a,b,c){return a.getItem(b.apiURL(),"/data-categories")}]}}).when("/categories/:category_id",{templateUrl:"views/category.html",controller:"CategoryCtrl",resolve:{category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/data-categories/"+a.current.params.category_id)}],items:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/data-categories/"+a.current.params.category_id+"/data-items")}]}}).when("/create-category",{templateUrl:"views/category.html",controller:"CategoryCtrl",resolve:{category:function(){return null},items:function(){return null}}}).when("/categories/:category_id/items/:item_id",{templateUrl:"views/item.html",controller:"ItemCtrl",resolve:{category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/data-categories/"+a.current.params.category_id)}],item:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/data-categories/"+a.current.params.category_id+"/data-items/"+a.current.params.item_id)}]}}).when("/categories/:category_id/create-data-item",{templateUrl:"views/item.html",controller:"ItemCtrl",resolve:{category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/data-categories/"+a.current.params.category_id)}],item:function(){return null}}}).when("/lea-categories",{templateUrl:"views/lea-category-list.html",controller:"LEACategoryListCtrl",resolve:{lea_categories:["dataProviderService","urls","envOptions",function(a,b,c){return a.getItem(b.apiURL(),"/lea-categories")}]}}).when("/lea-categories/:category_id",{templateUrl:"views/lea-category.html",controller:"LEACategoryCtrl",resolve:{lea_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/lea-categories/"+a.current.params.category_id)}],lea_actions:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/lea-categories/"+a.current.params.category_id+"/lea-actions")}]}}).when("/create-lea-category",{templateUrl:"views/lea-category.html",controller:"LEACategoryCtrl",resolve:{lea_category:function(){return null},lea_actions:function(){return null}}}).when("/lea-categories/:category_id/lea-actions/:action_id",{templateUrl:"views/lea-action.html",controller:"LEAActionCtrl",resolve:{lea_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/lea-categories/"+a.current.params.category_id)}],lea_action:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/lea-categories/"+a.current.params.category_id+"/lea-actions/"+a.current.params.action_id)}]}}).when("/lea-categories/:category_id/create-lea-action",{templateUrl:"views/lea-action.html",controller:"LEAActionCtrl",resolve:{lea_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/lea-categories/"+a.current.params.category_id)}],lea_action:function(){return null}}}).when("/reports/:report_id/lea-handbook",{templateUrl:"views/lea-handbook.html",controller:"LEAHandbookCtrl",resolve:{report:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id)}],handbook:["$route","dataProviderService","urls","envOptions","$q",function(a,b,c,d,e){return e(function(d,e){b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/law-enforcement-handbook").then(function(f){f?d(f):b.putItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/law-enforcement-handbook",{},{}).then(function(a){d(a)})["catch"](function(a){e(a)})})["catch"](function(a){e(a)})})}]}}).when("/gov-request-categories",{templateUrl:"views/gov-request-category-list.html",controller:"GovRequestCategoryListCtrl",resolve:{gov_request_categories:["dataProviderService","urls","envOptions",function(a,b,c){return a.getItem(b.apiURL(),"/gov-request-categories")}]}}).when("/gov-request-categories/:category_id",{templateUrl:"views/gov-request-category.html",controller:"GovRequestCategoryCtrl",resolve:{gov_request_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-categories/"+a.current.params.category_id)}],gov_request_types:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-categories/"+a.current.params.category_id+"/gov-request-types")}]}}).when("/create-gov-request-category",{templateUrl:"views/gov-request-category.html",controller:"GovRequestCategoryCtrl",resolve:{gov_request_category:function(){return null},gov_request_types:function(){return null}}}).when("/gov-request-categories/:category_id/gov-request-types/:type_id",{templateUrl:"views/gov-request-type.html",controller:"GovRequestTypeCtrl",resolve:{gov_request_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-categories/"+a.current.params.category_id)}],gov_request_type:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-categories/"+a.current.params.category_id+"/gov-request-types/"+a.current.params.type_id)}]}}).when("/gov-request-categories/:category_id/create-gov-request-type",{templateUrl:"views/gov-request-type.html",controller:"GovRequestTypeCtrl",resolve:{gov_request_category:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-categories/"+a.current.params.category_id)}],gov_request_type:function(){return null}}}).when("/gov-request-responses",{templateUrl:"views/gov-request-response-list.html",controller:"GovRequestResponseListCtrl",resolve:{gov_request_responses:["dataProviderService","urls","envOptions",function(a,b,c){return a.getItem(b.apiURL(),"/gov-request-responses")}]}}).when("/gov-request-responses/:response_id",{templateUrl:"views/gov-request-response.html",controller:"GovRequestResponseCtrl",resolve:{gov_request_response:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/gov-request-responses/"+a.current.params.response_id)}]}}).when("/create-gov-request-response",{templateUrl:"views/gov-request-response.html",controller:"GovRequestResponseCtrl",resolve:{gov_request_response:function(){return null}}}).when("/reports/:report_id/gov-request-report",{templateUrl:"views/gov-request-report.html",controller:"GovRequestReportCtrl",resolve:{report:["$route","dataProviderService","urls","envOptions",function(a,b,c,d){return b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id)}],request_report:["$route","dataProviderService","urls","envOptions","$q",function(a,b,c,d,e){return e(function(d,e){b.getItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/gov-request-report").then(function(f){f?d(f):b.putItem(c.apiURL(),"/transparency-reports/"+a.current.params.report_id+"/gov-request-report",{},{}).then(function(a){d(a)})["catch"](function(a){e(a)})})["catch"](function(a){e(a)})})}]}}).when("/offline",{templateUrl:"views/offline.html"}).otherwise({redirectTo:"/"})}]);TransparencyApp.filter("object2Array",function(){return function(a){return _.toArray(a)}}),TransparencyApp.directive("focusMe",["$timeout","$parse",function(a,b){return{link:function(c,d,e){var f=b(e.focusMe);c.$watch(f,function(b){console.log("value=",b),b===!0&&a(function(){d[0].focus(),d[0].setSelectionRange(0,d[0].value.length)})})}}}]),TransparencyApp.factory("nagSvgHelper",["$timeout",function(a){var b={inject:function(a){window.IconicJS?window.IconicJS().inject(a):window.SVGInjector&&window.SVGInjector(a)}};return b}]),TransparencyApp.directive("nagSvg",["$compile","nagSvgHelper",function(a,b){return{link:function(a,b,c){a.$watch("svgpath",function(c){a.svgpath&&b[0].setAttribute("data-src",a.svgpath),window.SVGInjector(b[0])})},scope:{svgpath:"@"}}}]),TransparencyApp.run(["$translate","$cookies",function(a,b){var c=b.get("languageCode");c&&(c=c.replace(/\W/g,"")),console.log("cookie",c),c?(a.use(c),console.log(a.use())):navigator.language?a.use(navigator.language.substr(0,2)):a.use(envOptions.languageCode)}]),TransparencyApp.run(["$templateCache","$http",function(a,b){b.get("views/messages.html").then(function(b){a.put("status-messages",b.data)})}]),angular.module("config",[]).constant("envOptions",{apiDomain:"http://localhost:5000",apiRoot:"",apiPath:"/",languageCode:"en"}),TransparencyApp.controller("AdminCtrl",["$scope","$location",function(a,b){console.log("main"),a.hi="hello"}]),TransparencyApp.controller("ReportListCtrl",["$scope","$location","reports","urls","dataProviderService","$route",function(a,b,c,d,e,f){console.log("hi"),a.reports=c,a.apiURL=d.apiURL(),a.deleteReport=function(a){var b=window.confirm("Are you sure you want to delete this report?");b&&e.deleteItem(d.apiURL(),"/transparency-reports/"+a.report_id).then(function(a){f.reload()})}}]),TransparencyApp.controller("ReportCtrl",["$scope","$location","report","$route","urls","dataProviderService",function(a,b,c,d,e,f){a.isCreating=!0,a.apiURL=e.apiURL(),null!==c&&(console.log(c),c.report_period_start=c.report_period_start,c.report_period_end=c.report_period_end,c.publication_date=c.publication_date,c.guidePath="#/reports/"+c.report_id+"/retention-guide",c.handbookPath="#/reports/"+c.report_id+"/lea-handbook",c.govRequestsReportPath="#/reports/"+c.report_id+"/gov-request-report",a.report=c,a.isCreating=!1),a.save=function(){var c=g();console.log(c);var d;d=a.isCreating?f.putItem(e.apiURL(),"/transparency-reports",{},c):f.postItem(e.apiURL(),"/transparency-reports/"+a.report.report_id,{},c),d.then(function(c){a.unSavedChanges=!1,b.path("/reports/"+c.report_id)})},a.$on("$locationChangeStart",function(b){a.unSavedChanges&&!confirm("You have unsaved changes, continue?")&&b.preventDefault()});var g=function(){var b={};return b.author_name=a.report.author_name,b.report_period_start=a.report.report_period_start,b.report_period_end=a.report.report_period_end,b.publication_date=a.report.publication_date,b.retention_guide_inclusion_status=a.report.retention_guide_inclusion_status,b.government_requests_report_inclusion_status=a.report.government_requests_report_inclusion_status,b.law_enforcement_handbook_inclusion_status=a.report.law_enforcement_handbook_inclusion_status,angular.toJson(b)};a.$watch("report",function(b,c){c!==b&&(a.unSavedChanges=!0)},!0)}]),TransparencyApp.controller("RetentionGuideCtrl",["$scope","$location","guide","report","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),null!==d&&(d.report_period_start=moment(d.report_period_start).toDate(),d.report_period_end=moment(d.report_period_end).toDate(),d.publication_date=moment(d.publication_date).toDate(),a.report=d),console.log(c),null!==c?(a.guide=c,a.isCreating=!1):(a.guide={inclusion_status:!0,complete_status:!1},console.log(a.guide.data_categories)),a.newCategory={},a.addingCategory=null,a.toggleAddingForm=function(b){console.log(b),a.addingCategory&&b.guide_category_id==a.addingCategory.guide_category_id?a.addingCategory=null:(a.addingCategory=angular.copy(b),a.addingCategory.newItem={})},a.save=function(){var b,c=h();b=a.isCreating?g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/retention_guide",{},c):g.postItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/retention_guide",{},c),b.then(function(b){i=h(),a.unSavedChanges=!1,e.reload()})},a.$on("$locationChangeStart",function(b){a.unSavedChanges&&!confirm("You have unsaved changes, continue?")&&b.preventDefault()}),a.saveItem=function(b){console.log(b);var c,e=b.newItem;c=g.putItem(f.apiURL(),"/data-categories/"+b.parent_category_id+"/data-items",{},e),c.then(function(c){console.log(c),g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/retention_guide/data-categories/"+b.guide_category_id+"/data-items",{},c).then(function(c){a.unSavedChanges||(a.justAddedItemFresh=!0);var d=_.findWhere(a.guide.data_categories,{guide_category_id:b.guide_category_id});d.items.push(c),a.addingCategory=null,i=h()})})},a.saveCategory=function(){console.log(a.newCategory);var b,c=a.newCategory;b=g.putItem(f.apiURL(),"/data-categories",{},c),b.then(function(b){console.log(b),g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/retention_guide/data-categories",{},b).then(function(b){a.unSavedChanges||(a.justAddedItemFresh=!0),console.log(b),a.guide.data_categories.push(b),a.newCategory={},a.addingNewCategory=!1,i=h()})})};var h=function(){var b={};return b.inclusion_status=a.guide.inclusion_status,b.complete_status=a.guide.complete_status,b.narrative=a.guide.narrative,b.data_categories=a.guide.data_categories,angular.toJson(b)},i=h();a.$watch("guide",function(b,c){i!==h()?a.justAddedItemFresh?(a.unSavedChanges=!1,a.justAddedItemFresh=!1):a.unSavedChanges=!0:(a.justAddedItemFresh=!1,a.unSavedChanges=!1)},!0)}]),TransparencyApp.controller("CategoryListCtrl",["$scope","$location","categories","urls","dataProviderService","$route",function(a,b,c,d,e,f){console.log("hi"),a.categories=c,a.apiURL=d.apiURL(),a.deleteCategory=function(a){var b=window.confirm("Are you sure you want to delete this category?");b&&e.deleteItem(d.apiURL(),"/data-categories/"+a.category_id).then(function(a){f.reload()})}}]),TransparencyApp.controller("CategoryCtrl",["$scope","$location","category","items","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),null!==c&&(c.itemPath="#/categories/"+c.category_id+"/create-data-item",a.category=c,a.items=d,a.isCreating=!1),a.save=function(){var c,d=h();c=a.isCreating?g.putItem(f.apiURL(),"/data-categories",{},d):g.postItem(f.apiURL(),"/data-categories/"+a.category.category_id,{},d),c.then(function(a){b.path("/categories/")})};var h=function(){var b={};return b.name=a.category.name,b.description=a.category.description,angular.toJson(b)};a.deleteItem=function(a){var b=window.confirm("Are you sure you want to delete this item?");b&&g.deleteItem(f.apiURL(),"/data-categories/"+c.category_id+"/data-items/"+a.item_id).then(function(){e.reload()})}}]),TransparencyApp.controller("ItemCtrl",["$scope","$location","category","item","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),a.categoryPath="#/categories/"+c.category_id,a.category=c,null!==d&&(a.item=d,a.isCreating=!1),a.save=function(){var d,e=h();d=a.isCreating?g.putItem(f.apiURL(),"/data-categories/"+c.category_id+"/data-items",{},e):g.postItem(f.apiURL(),"/data-categories/"+c.category_id+"/data-items/"+a.item.item_id,{},e),d.then(function(a){b.path("/categories/"+c.category_id)})};var h=function(){var b={};return b.name=a.item.name,b.description=a.item.description,angular.toJson(b)}}]),TransparencyApp.controller("LEACategoryListCtrl",["$scope","$location","lea_categories","urls","dataProviderService","$route",function(a,b,c,d,e,f){console.log("hi"),a.lea_categories=c,a.apiURL=d.apiURL(),a.deleteCategory=function(a){var b=window.confirm("Are you sure you want to delete this category?");b&&e.deleteItem(d.apiURL(),"/lea-categories/"+a.category_id).then(function(a){f.reload()})}}]),TransparencyApp.controller("LEACategoryCtrl",["$scope","$location","lea_category","lea_actions","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),a.action_selection_types=[{id:1,name:"Single value"},{id:2,name:"Multiple value"},{id:3,name:"Text value"}],null!==c&&(c.actionPath="#/lea-categories/"+c.category_id+"/create-lea-action",a.lea_category=c,a.lea_actions=d,a.isCreating=!1,c.action_selection_type,a.selected_action_selection_type=_.findWhere(a.action_selection_types,{id:c.action_selection_type})),a.save=function(){var c,d=h();c=a.isCreating?g.putItem(f.apiURL(),"/lea-categories",{},d):g.postItem(f.apiURL(),"/lea-categories/"+a.lea_category.category_id,{},d),c.then(function(a){b.path("/lea-categories/")})};var h=function(){var b={};return b.name=a.lea_category.name,b.description=a.lea_category.description,b.action_selection_type=a.selected_action_selection_type.id,angular.toJson(b)};a.deleteAction=function(a){var b=window.confirm("Are you sure you want to delete this?");b&&g.deleteItem(f.apiURL(),"/lea-categories/"+c.category_id+"/lea-actions/"+a.action_id).then(function(){e.reload()})}}]),TransparencyApp.controller("LEAActionCtrl",["$scope","$location","lea_category","lea_action","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),a.lea_categoryPath="#/lea-categories/"+c.category_id,a.lea_category=c,null!==d&&(a.lea_action=d,a.isCreating=!1),a.save=function(){var d,e=h();d=a.isCreating?g.putItem(f.apiURL(),"/lea-categories/"+c.category_id+"/lea-actions",{},e):g.postItem(f.apiURL(),"/lea-categories/"+c.category_id+"/lea-actions/"+a.lea_action.action_id,{},e),d.then(function(a){b.path("/lea-categories/"+c.category_id)})};var h=function(){var b={};return b.name=a.lea_action.name,b.narrative=a.lea_action.narrative,b.narrative_label=a.lea_action.narrative_label,b.inclusion_status_default=a.lea_action.inclusion_status_default,angular.toJson(b)}}]),TransparencyApp.controller("LEAHandbookCtrl",["$scope","$location","handbook","report","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){if(a.isCreating=!0,a.apiURL=f.apiURL(),a.trueValue=!0,null!==d&&(d.report_period_start=moment(d.report_period_start).toDate(),d.report_period_end=moment(d.report_period_end).toDate(),d.publication_date=moment(d.publication_date).toDate(),a.report=d),a.action_selection_types=[{id:1,name:"Single value"},{id:2,name:"Multiple value"},{id:3,name:"Text value"}],a.selectOption=function(a,b){console.log(a,b);for(var c=0;c<a.length;c++)a[c]!==b?a[c].inclusion_status=!1:a[c].inclusion_status=!0},console.log(c),null!==c)a.handbook=c,a.isCreating=!1;else{a.handbook={inclusion_status:!0,complete_status:!1};for(category in a.handbook.categories)category.addingItem=!1,category.newItem={};a.addingCategory=!1}a.newCategory={},a.selected_action_selection_type={},a.currentLEAAction=null,a.showActionDetail=function(b){a.currentLEAAction&&a.currentLEAAction.handbook_action_id==b.handbook_action_id?a.currentLEAAction=null:a.currentLEAAction=angular.copy(b)},a.addingCategory=null,a.toggleAddingForm=function(b){console.log(b),a.addingCategory&&b.handbook_category_id==a.addingCategory.handbook_category_id?a.addingCategory=null:(a.addingCategory=angular.copy(b),a.addingCategory.newItem={})},a.closeNarrative=function(b){"dropdown"!==b.target.className&&-1===String(b.target.className).indexOf("button")&&"path"!==b.target.tagName&&"svg"!==b.target.tagName&&"dropdown"!==b.target.parentNode.className&&"dropdown"!==b.target.parentNode.parentNode.className&&(a.currentLEAAction=null)},a.save=function(){var b,c=h();b=a.isCreating?g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/law-enforcement-handbook",{},c):g.postItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/law-enforcement-handbook",{},c),b.then(function(b){a.unSavedChanges=!1,e.reload()})},a.$on("$locationChangeStart",function(b){a.unSavedChanges&&!confirm("You have unsaved changes, continue?")&&b.preventDefault()}),a.saveAction=function(b){console.log(b);var c,e=b.newAction;c=g.putItem(f.apiURL(),"/lea-categories/"+b.parent_category_id+"/lea-actions",{},e),c.then(function(c){console.log(c,b),g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/law-enforcement-handbook/lea-categories/"+b.handbook_category_id+"/lea-actions",{},c).then(function(c){a.unSavedChanges||(a.justAddedItemFresh=!0);var d=_.findWhere(a.handbook.categories,{handbook_category_id:b.handbook_category_id});d.actions.push(c),a.addingCategory=null,i=h()})})},a.saveCategory=function(){console.log(a.newCategory);var b,c=a.newCategory;c.action_selection_type=a.selected_action_selection_type.id,console.log(c),b=g.putItem(f.apiURL(),"/lea-categories",{},c),b.then(function(b){console.log(b),g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/law-enforcement-handbook/lea-categories",{},b).then(function(b){console.log(b),a.handbook.categories.push(b),a.newCategory={},a.selected_action_selection_type=null,i=h()})})};var h=function(){var b={};return b.inclusion_status=a.handbook.inclusion_status,b.complete_status=a.handbook.complete_status,b.narrative=a.handbook.narrative,b.lea_categories=a.handbook.categories,console.log(b),angular.toJson(b)},i=h();a.$watch("handbook",function(b,c){i!==h()?a.justAddedItemFresh?(a.unSavedChanges=!1,a.justAddedItemFresh=!1):a.unSavedChanges=!0:(a.unSavedChanges=!1,a.justAddedItemFresh=!1)},!0)}]),TransparencyApp.controller("GovRequestCategoryListCtrl",["$scope","$location","gov_request_categories","urls","dataProviderService","$route",function(a,b,c,d,e,f){console.log("hi"),a.gov_request_categories=c,a.apiURL=d.apiURL(),a.deleteCategory=function(a){var b=window.confirm("Are you sure you want to delete this category?");b&&e.deleteItem(d.apiURL(),"/gov-request-categories/"+a.category_id).then(function(a){f.reload()})}}]),TransparencyApp.controller("GovRequestCategoryCtrl",["$scope","$location","gov_request_category","gov_request_types","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),null!==c&&(c.typePath="#/gov-request-categories/"+c.category_id+"/create-gov-request-type",a.gov_request_category=c,a.gov_request_types=d,a.isCreating=!1),a.save=function(){var c,d=h();c=a.isCreating?g.putItem(f.apiURL(),"/gov-request-categories",{},d):g.postItem(f.apiURL(),"/gov-request-categories/"+a.gov_request_category.category_id,{},d),c.then(function(a){b.path("/gov-request-categories/")})};var h=function(){var b={};return b.name=a.gov_request_category.name,b.description=a.gov_request_category.description,angular.toJson(b)};a.deleteType=function(a){var b=window.confirm("Are you sure you want to delete this?");b&&g.deleteItem(f.apiURL(),"/gov-request-categories/"+c.category_id+"/gov-request-types/"+a.type_id).then(function(){e.reload()})}}]),TransparencyApp.controller("GovRequestTypeCtrl",["$scope","$location","gov_request_category","gov_request_type","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){a.isCreating=!0,a.apiURL=f.apiURL(),a.gov_request_categoryPath="#/gov-request-categories/"+c.category_id,a.gov_request_category=c,null!==d&&(a.gov_request_type=d,a.isCreating=!1),a.save=function(){var d,e=h();d=a.isCreating?g.putItem(f.apiURL(),"/gov-request-categories/"+c.category_id+"/gov-request-types",{},e):g.postItem(f.apiURL(),"/gov-request-categories/"+c.category_id+"/gov-request-types/"+a.gov_request_type.type_id,{},e),d.then(function(a){b.path("/gov-request-categories/"+c.category_id)})};var h=function(){var b={};return b.name=a.gov_request_type.name,b.description=a.gov_request_type.description,angular.toJson(b)}}]),TransparencyApp.controller("GovRequestResponseListCtrl",["$scope","$location","gov_request_responses","urls","dataProviderService","$route",function(a,b,c,d,e,f){console.log("hi"),a.gov_request_responses=c,a.apiURL=d.apiURL(),a.deleteResponse=function(a){var b=window.confirm("Are you sure you want to delete this?");b&&e.deleteItem(d.apiURL(),"/gov-request-responses/"+a.response_id).then(function(a){f.reload()})}}]),TransparencyApp.controller("GovRequestResponseCtrl",["$scope","$location","gov_request_response","$route","urls","dataProviderService",function(a,b,c,d,e,f){a.isCreating=!0,a.apiURL=e.apiURL(),null!==c&&(a.gov_request_response=c,a.isCreating=!1),a.save=function(){var c,d=g();c=a.isCreating?f.putItem(e.apiURL(),"/gov-request-responses",{},d):f.postItem(e.apiURL(),"/gov-request-responses/"+a.gov_request_response.response_id,{},d),
c.then(function(a){b.path("/gov-request-responses/")})};var g=function(){var b={};return b.name=a.gov_request_response.name,b.description=a.gov_request_response.description,angular.toJson(b)}}]),TransparencyApp.controller("GovRequestReportCtrl",["$scope","$location","request_report","report","$route","urls","dataProviderService",function(a,b,c,d,e,f,g){if(a.isCreating=!0,a.apiURL=f.apiURL(),null!==d&&(d.report_period_start=moment(d.report_period_start).toDate(),d.report_period_end=moment(d.report_period_end).toDate(),d.publication_date=moment(d.publication_date).toDate(),a.report=d),console.log(c),null!==c){a.request_report=c,a.isCreating=!1,a.header=c.categorized_disclosures[Object.keys(c.categorized_disclosures)[0]].disclosures[0].disclosure_responses,a.totals=[];for(var h in c.categorized_disclosures)a.request_report.categorized_disclosures[h].addingRequestType=!1,a.request_report.categorized_disclosures[h].newRequestType={};a.addingCategory=!1}else a.request_report={inclusion_status:!0,complete_status:!1};a.currentDisclosure=null,a.currentHeader=null,a.showDisclosure=function(b){a.currentDisclosure&&a.currentDisclosure.disclosure_id==b.disclosure_id?a.currentDisclosure=null:a.currentDisclosure=angular.copy(b),a.currentHeader=null},a.showHeaderDescription=function(b){a.currentHeader&&a.currentHeader.type_disclosure_id==b.type_disclosure_id?a.currentHeader=null:a.currentHeader=angular.copy(b),a.currentDisclosure=null},a.closeDropdown=function(b){"dropdown"!==b.target.className&&-1===String(b.target.className).indexOf("button")&&"path"!==b.target.tagName&&"svg"!==b.target.tagName&&(a.currentDisclosure=null,a.currentHeader=null)};var i=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};a.compileTotals=function(){a.totals=[];for(var b=0;b<a.header.length;b++){var c=0;for(var d in a.request_report.categorized_disclosures)for(var e=0;e<a.request_report.categorized_disclosures[d].disclosures.length;e++){var f=a.request_report.categorized_disclosures[d].disclosures[e].disclosure_responses[b].count;parseInt(f)&&(c+=parseInt(f))}a.totals.push(i(c))}},a.compileTotals(),a.save=function(){var b,c=j();b=a.isCreating?g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/gov-request-report",{},c):g.postItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/gov-request-report",{},c),b.then(function(b){a.unSavedChanges=!1,k=j(),e.reload()})},a.$on("$locationChangeStart",function(b){a.unSavedChanges&&!confirm("You have unsaved changes, continue?")&&b.preventDefault()}),a.saveRequestType=function(a){console.log(a);var b,c=a.newRequestType;b=g.putItem(f.apiURL(),"/gov-request-categories/"+a.category_id+"/gov-request-types",{},c),b.then(function(b){console.log(b),g.putItem(f.apiURL(),"/transparency-reports/"+d.report_id+"/gov-request-report/gov-request-categories/"+b.category.category_id+"/gov-request-types",{},b).then(function(b){console.log(b),a.newDisclosure={},a.disclosures.push(b),k=j()})})};var j=function(){var b={};return b.inclusion_status=a.request_report.inclusion_status,b.complete_status=a.request_report.complete_status,b.narrative=a.request_report.narrative,b.categorized_disclosures=a.request_report.categorized_disclosures,angular.toJson(b)},k=j();a.$watch("request_report",function(b,c){k!==j()?a.unSavedChanges=!0:a.unSavedChanges=!1},!0)}]);